{
  "text": " ```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pro-Flight Glass Cockpit System</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <link href=\"https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap\" rel=\"stylesheet\">\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: {\n                        mono: ['\"JetBrains Mono\"', 'monospace'],\n                        sans: ['\"Inter\"', 'sans-serif'],\n                    },\n                    colors: {\n                        glass: 'rgba(20, 25, 35, 0.85)',\n                        glassBorder: 'rgba(255, 255, 255, 0.1)',\n                        primary: '#00d2ff',\n                        warning: '#ffcc00',\n                        danger: '#ff3333',\n                        success: '#00ff66',\n                        dim: 'rgba(255,255,255,0.3)'\n                    }\n                }\n            }\n        }\n    </script>\n    <style>\n        body {\n            background-color: #050505;\n            color: #e0e0e0;\n            overflow: hidden;\n        }\n        \n        /* CRT/Scanline Effect */\n        .scanlines::before {\n            content: \" \";\n            display: block;\n            position: absolute;\n            top: 0;\n            left: 0;\n            bottom: 0;\n            right: 0;\n            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));\n            z-index: 50;\n            background-size: 100% 2px, 3px 100%;\n            pointer-events: none;\n        }\n        \n        .bezel {\n            box-shadow: inset 0 0 20px #000, 0 0 10px rgba(0,0,0,0.8);\n            border: 12px solid #1a1a1a;\n            border-radius: 10px;\n            position: relative;\n        }\n\n        /* Custom Scrollbar for lists */\n        ::-webkit-scrollbar { width: 4px; }\n        ::-webkit-scrollbar-track { background: #000; }\n        ::-webkit-scrollbar-thumb { background: #333; }\n\n        /* Rotary Knob Animation placeholder */\n        .knob {\n            transition: transform 0.1s;\n        }\n\n        /* Horizon Gradient */\n        .sky { background: linear-gradient(to bottom, #0055aa 0%, #0088cc 100%); }\n        .ground { background: linear-gradient(to bottom, #5c4033 0%, #3e2b22 100%); }\n    </style>\n</head>\n<body class=\"h-screen w-screen flex flex-col font-mono text-sm select-none\">\n\n    <!-- TOP BAR: Status & Annunciators -->\n    <div class=\"h-12 bg-black border-b border-gray-800 flex items-center justify-between px-4 z-50 relative\">\n        <div class=\"flex items-center space-x-4\">\n            <div class=\"text-primary font-bold text-lg tracking-widest\">AERO-SYS <span class=\"text-xs text-gray-500\">v4.2.1</span></div>\n            <div class=\"flex space-x-2\" id=\"master-warning-panel\">\n                <!-- Warning/Caution Lights populated by JS -->\n            </div>\n        </div>\n        <div class=\"flex items-center space-x-6 text-xs\">\n            <div class=\"flex flex-col items-end\">\n                <span class=\"text-gray-500\">UTC TIME</span>\n                <span class=\"text-white font-bold text-base\" id=\"clock\">12:00:00</span>\n            </div>\n            <div class=\"flex flex-col items-end\">\n                <span class=\"text-gray-500\">BAT</span>\n                <span class=\"text-success\">28.2V</span>\n            </div>\n        </div>\n    </div>\n\n    <!-- MAIN COCKPIT DISPLAYS -->\n    <div class=\"flex-1 flex bg-black relative scanlines\">\n        \n        <!-- LEFT: PFD (Primary Flight Display) -->\n        <div class=\"w-1/3 p-2 flex flex-col\">\n            <div class=\"bezel flex-1 bg-black relative overflow-hidden scanlines\" id=\"pfd-container\">\n                <!-- PFD Canvas -->\n                <canvas id=\"pfd-canvas\" class=\"w-full h-full\"></canvas>\n                \n                <!-- Synthetic Vision/Attitude Overlay -->\n                <div id=\"attitude-overlay\" class=\"absolute inset-0 pointer-events-none flex items-center justify-center overflow-hidden\">\n                    <div id=\"horizon-line\" class=\"w-[200%] h-[200%] sky relative transition-transform duration-75 ease-linear\" style=\"transform: rotate(0deg) translateY(0px);\">\n                        <div class=\"absolute bottom-1/2 top-0 w-full sky\"></div> <!-- Sky -->\n                        <div class=\"absolute top-1/2 bottom-0 w-full ground border-t-4 border-white\"></div> <!-- Ground -->\n                        <!-- Pitch Ladder (Visual only, handled in canvas mostly but this adds depth) -->\n                        <div class=\"absolute top-1/2 left-1/2 w-full -translate-x-1/2 flex flex-col items-center opacity-80\">\n                             <!-- Generated via JS for dynamic pitch -->\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Flight Director / FP Symbol -->\n                <div class=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\n                    <div id=\"flight-director\" class=\"w-16 h-16 border-2 border-primary rounded-full opacity-80 flex items-center justify-center transition-all duration-300\">\n                        <div class=\"w-2 h-2 bg-primary rounded-full\"></div>\n                        <div class=\"absolute w-8 h-0.5 bg-primary\"></div>\n                        <div class=\"absolute h-8 w-0.5 bg-primary\"></div>\n                    </div>\n                    <!-- Fixed Aircraft Reference -->\n                    <div class=\"absolute w-48 h-1 bg-yellow-400 shadow-[0_0_10px_rgba(250,204,21,0.8)]\"></div>\n                    <div class=\"absolute w-1 h-6 bg-yellow-400 -ml-24\"></div>\n                    <div class=\"absolute w-1 h-6 bg-yellow-400 ml-24\"></div>\n                </div>\n\n                <!-- Airspeed Tape (Left) -->\n                <div class=\"absolute left-4 top-10 bottom-10 w-16 flex flex-col items-center justify-center overflow-hidden pointer-events-none\">\n                    <div id=\"spd-tape\" class=\"absolute text-center transition-transform duration-75\">\n                        <!-- Generated by JS -->\n                    </div>\n                    <div class=\"absolute right-0 w-0 h-0 border-t-[10px] border-t-transparent border-l-[15px] border-l-warning border-b-[10px] border-b-transparent z-10\"></div>\n                    <div class=\"absolute bottom-[-20px] text-3xl font-bold text-primary drop-shadow-md\" id=\"spd-readout\">240</div>\n                </div>\n\n                <!-- Altitude Tape (Right) -->\n                <div class=\"absolute right-4 top-10 bottom-10 w-20 flex flex-col items-center justify-center overflow-hidden pointer-events-none\">\n                    <div id=\"alt-tape\" class=\"absolute text-center transition-transform duration-75\">\n                        <!-- Generated by JS -->\n                    </div>\n                    <div class=\"absolute left-0 w-0 h-0 border-t-[10px] border-t-transparent border-r-[15px] border-r-warning border-b-[10px] border-b-transparent z-10\"></div>\n                    <div class=\"absolute bottom-[-20px] text-3xl font-bold text-primary drop-shadow-md\" id=\"alt-readout\">15200</div>\n                </div>\n                \n                <!-- Heading Strip (Bottom) -->\n                <div class=\"absolute bottom-2 left-10 right-10 h-12 overflow-hidden border-t border-white/20 pointer-events-none\">\n                     <div id=\"hdg-tape\" class=\"flex items-center h-full transition-transform duration-75\">\n                        <!-- Generated by JS -->\n                     </div>\n                     <div class=\"absolute left-1/2 top-0 -translate-x-1/2 w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-transparent border-t-[10px] border-t-warning z-10\"></div>\n                </div>\n\n                <!-- AP Status (Top Center) -->\n                <div class=\"absolute top-4 left-1/2 -translate-x-1/2 flex space-x-2 text-[10px] font-bold bg-black/50 px-2 py-1 rounded border border-white/10\">\n                    <span class=\"text-green-400\">LNV</span>\n                    <span class=\"text-green-400\">VNAV</span>\n                    <span class=\"text-primary\">FLC</span>\n                    <span class=\"text-white\">ALT</span>\n                </div>\n            </div>\n        </div>\n\n        <!-- CENTER: ND (Navigation Display) -->\n        <div class=\"w-1/3 p-2 flex flex-col\">\n            <div class=\"bezel flex-1 bg-black relative overflow-hidden\">\n                <canvas id=\"nd-canvas\" class=\"w-full h-full\"></canvas>\n                <!-- Map Overlays -->\n                <div class=\"absolute top-4 left-4 text-xs\">\n                    <div class=\"text-primary font-bold\">ROSE NAV</div>\n                    <div class=\"text-white\">TERR</div>\n                </div>\n                <div class=\"absolute top-4 right-4 text-right text-xs\">\n                    <div class=\"text-xs text-gray-400\">NEXT WAYPOINT</div>\n                    <div class=\"text-primary font-bold text-lg\">KSEA</div>\n                    <div class=\"text-white\">45.2 NM</div>\n                </div>\n                <!-- VOR Info -->\n                <div class=\"absolute bottom-4 left-4 text-xs bg-black/60 p-2 rounded border border-gray-700\">\n                    <div class=\"flex justify-between space-x-4\">\n                        <span class=\"text-primary\">VOR1</span>\n                        <span>110.50</span>\n                        <span class=\"text-warning\">TO</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- RIGHT: EICAS (Engine + Systems) -->\n        <div class=\"w-1/3 p-2 flex flex-col\">\n            <div class=\"bezel flex-1 bg-black relative p-4 flex flex-col justify-between overflow-hidden\">\n                \n                <!-- Engine Gauges -->\n                <div class=\"grid grid-cols-2 gap-4 mb-2\">\n                    <div class=\"flex flex-col\">\n                        <div class=\"flex justify-between text-xs mb-1\"><span>N1</span> <span class=\"text-primary\" id=\"n1-val\">88.4%</span></div>\n                        <div class=\"h-4 bg-gray-800 rounded overflow-hidden relative border border-gray-600\">\n                            <div id=\"n1-bar\" class=\"h-full bg-gradient-to-r from-green-500 to-green-300 w-[88%] transition-all duration-500\"></div>\n                            <div class=\"absolute top-0 bottom-0 left-[95%] w-0.5 bg-red-500\"></div> <!-- Redline -->\n                        </div>\n                    </div>\n                    <div class=\"flex flex-col\">\n                        <div class=\"flex justify-between text-xs mb-1\"><span>N2</span> <span class=\"text-primary\" id=\"n2-val\">91.2%</span></div>\n                        <div class=\"h-4 bg-gray-800 rounded overflow-hidden relative border border-gray-600\">\n                            <div id=\"n2-bar\" class=\"h-full bg-gradient-to-r from-green-500 to-green-300 w-[91%] transition-all duration-500\"></div>\n                        </div>\n                    </div>\n                    <div class=\"flex flex-col\">\n                        <div class=\"flex justify-between text-xs mb-1\"><span>EGT</span> <span class=\"text-warning\" id=\"egt-val\">560°C</span></div>\n                        <div class=\"h-4 bg-gray-800 rounded overflow-hidden relative border border-gray-600\">\n                            <div id=\"egt-bar\" class=\"h-full bg-gradient-to-r from-orange-500 to-red-500 w-[65%] transition-all duration-500\"></div>\n                        </div>\n                    </div>\n                    <div class=\"flex flex-col\">\n                        <div class=\"flex justify-between text-xs mb-1\"><span>F.FLOW</span> <span class=\"text-white\">2400</span></div>\n                        <div class=\"text-right text-[10px] text-gray-500\">PPH</div>\n                    </div>\n                </div>\n\n                <!-- Artificial Horizon Backup -->\n                <div class=\"flex-1 border border-gray-700 rounded relative overflow-hidden bg-gradient-to-b from-gray-900 to-black\">\n                     <div class=\"absolute top-1/2 w-full h-[1px] bg-white opacity-30\"></div>\n                     <div class=\"absolute left-1/2 h-full w-[1px] bg-white opacity-30\"></div>\n                     <!-- TCAS Traffic Widget -->\n                     <div class=\"absolute top-4 right-4 w-24 h-24 border border-gray-600 rounded-full opacity-60 bg-gray-900/50 flex items-center justify-center\">\n                        <div class=\"w-1 h-1 bg-white\"></div> <!-- Ownship -->\n                        <div class=\"absolute w-2 h-2 bg-danger rounded-full top-6 left-10 animate-pulse\"></div> <!-- Threat -->\n                     </div>\n                     <div class=\"absolute bottom-2 left-2 text-[10px] text-gray-400\">\n                        OAT: -12°C<br>\n                        SAT: -24°C<br>\n                        TAT: -8°C\n                     </div>\n                </div>\n                \n                <!-- Landing Gear Visual -->\n                <div class=\"mt-2 flex justify-center space-x-4\">\n                    <div class=\"flex flex-col items-center\">\n                        <div class=\"w-6 h-6 border border-gray-500 rounded-full flex items-center justify-center text-[10px] text-green-400 font-bold bg-gray-800/50\">L</div>\n                        <span class=\"text-[9px] text-gray-500 mt-1\">GR</span>\n                    </div>\n                     <div class=\"flex flex-col items-center\">\n                        <div class=\"w-6 h-6 border border-gray-500 rounded-full flex items-center justify-center text-[10px] text-green-400 font-bold bg-gray-800/50\">N</div>\n                        <span class=\"text-[9px] text-gray-500 mt-1\">GR</span>\n                    </div>\n                     <div class=\"flex flex-col items-center\">\n                        <div class=\"w-6 h-6 border border-gray-500 rounded-full flex items-center justify-center text-[10px] text-green-400 font-bold bg-gray-800/50\">R</div>\n                        <span class=\"text-[9px] text-gray-500 mt-1\">GR</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- BOTTOM CONSOLE: Controls, Autopilot, FMS -->\n    <div class=\"h-64 bg-[#0f1115] border-t border-gray-700 grid grid-cols-12 gap-2 p-2 z-40 shadow-[0_-5px_20px_rgba(0,0,0,0.8)]\">\n        \n        <!-- COM Panel -->\n        <div class=\"col-span-2 bg-gray-900 rounded border border-gray-700 p-3 flex flex-col justify-between\">\n            <div class=\"text-[10px] text-gray-500 font-bold mb-1\">RADIO / COM</div>\n            <div class=\"bg-black p-2 rounded border border-gray-600 mb-2 relative overflow-hidden\">\n                <div class=\"text-right text-xl text-primary font-mono tracking-widest\" id=\"com-display\">124.850</div>\n                <div class=\"absolute bottom-1 right-2 text-[8px] text-gray-600\">VHF1</div>\n            </div>\n            <div class=\"grid grid-cols-3 gap-1\">\n                <button class=\"bg-gray-800 hover:bg-gray-700 text-xs p-2 rounded border border-gray-600 text-white transition\" onclick=\"tuneRadio(-0.025)\">◀</button>\n                <button class=\"bg-gray-800 hover:bg-gray-700 text-xs p-2 rounded border border-gray-600 text-primary font-bold transition\" onclick=\"swapRadio()\">⇄</button>\n                <button class=\"bg-gray-800 hover:bg-gray-700 text-xs p-2 rounded border border-gray-600 text-white transition\" onclick=\"tuneRadio(0.025)\">▶</button>\n            </div>\n        </div>\n\n        <!-- Mode Control Panel (MCP) / Autopilot -->\n        <div class=\"col-span-5 bg-gray-900 rounded border border-gray-700 p-3 grid grid-cols-2 gap-4 relative\">\n            <div class=\"absolute top-0 left-0 bg-gray-700 text-[9px] px-2 py-0.5 text-white rounded-br\">MODE CONTROL PANEL</div>\n            \n            <!-- Left Knobs -->\n            <div class=\"flex flex-col justify-center space-y-4\">\n                <div class=\"flex items-center space-x-3\">\n                    <div class=\"w-12 h-12 rounded-full bg-gradient-to-br from-gray-700 to-gray-900 border-2 border-gray-600 shadow-lg flex items-center justify-center cursor-pointer active:scale-95 transition group\" onclick=\"adjustAlt(-100)\">\n                        <div class=\"w-1 h-4 bg-white rounded\"></div>\n                        <div class=\"absolute text-[8px] -bottom-4 text-gray-500\">SPD</div>\n                    </div>\n                    <div class=\"flex-1 bg-black border border-gray-600 rounded px-2 py-1 text-center text-primary font-mono text-lg\">FLC</div>\n                </div>\n                <div class=\"flex items-center space-x-3\">\n                    <div class=\"w-12 h-12 rounded-full bg-gradient-to-br from-gray-700 to-gray-900 border-2 border-gray-600 shadow-lg flex items-center justify-center cursor-pointer active:scale-95 transition\" onclick=\"adjustAlt(-100)\">\n                         <div class=\"w-1 h-4 bg-white rounded\"></div>\n                         <div class=\"absolute text-[8px] -bottom-4 text-gray-500\">HDG</div>\n                    </div>\n                    <div class=\"flex-1 bg-black border border-gray-600 rounded px-2 py-1 text-center text-primary font-mono text-lg\" id=\"hdg-val\">245°</div>\n                </div>\n            </div>\n\n            <!-- Right Knobs -->\n            <div class=\"flex flex-col justify-center space-y-4\">\n                 <div class=\"flex items-center space-x-3\">\n                    <div class=\"flex-1 bg-black border border-gray-600 rounded px-2 py-1 text-center text-primary font-mono text-lg\" id=\"alt-val\">FL280</div>\n                    <div class=\"w-12 h-12 rounded-full bg-gradient-to-br from-gray-700 to-gray-900 border-2 border-gray-600 shadow-lg flex items-center justify-center cursor-pointer active:scale-95 transition\" onclick=\"adjustAlt(100)\">\n                         <div class=\"w-1 h-4 bg-white rounded\"></div>\n                         <div class=\"absolute text-[8px] -bottom-4 text-gray-500\">ALT</div>\n                    </div>\n                </div>\n                <div class=\"flex items-center space-x-3\">\n                    <div class=\"flex-1 bg-black border border-gray-600 rounded px-2 py-1 text-center text-primary font-mono text-lg\">VS +1200</div>\n                    <div class=\"w-12 h-12 rounded-full bg-gradient-to-br from-gray-700 to-gray-900 border-2 border-gray-600 shadow-lg flex items-center justify-center cursor-pointer active:scale-95 transition\">\n                         <div class=\"w-1 h-4 bg-white rounded\"></div>\n                         <div class=\"absolute text-[8px] -bottom-4 text-gray-500\">V/S</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- FMS / FMC -->\n        <div class=\"col-span-3 bg-black rounded border-2 border-gray-600 p-2 flex flex-col font-mono\">\n            <div class=\"bg-[#1a1a20] flex-1 p-2 rounded text-xs grid grid-cols-2 gap-x-4 leading-relaxed\" id=\"fms-screen\">\n                <!-- Dynamic FMS Content -->\n                <div class=\"col-span-2 text-center text-gray-400 mb-1\">--- RTE 1 LEGS ---</div>\n                <div class=\"text-white\">WPT</div>\n                <div class=\"text-right text-primary\">DIST</div>\n                \n                <div class=\"text-white\">KBFI</div>\n                <div class=\"text-right text-primary\">0.0</div>\n                \n                <div class=\"text-white\">SEA</div>\n                <div class=\"text-right text-primary\">5.2</div>\n                \n                <div class=\"text-green-400\">►OLM</div>\n                <div class=\"text-right text-green-400\">48.5</div>\n                \n                <div class=\"text-white\">HQM</div>\n                <div class=\"text-right text-primary\">22.1</div>\n                \n                <div class=\"text-gray-500\">KSEA</div>\n                <div class=\"text-right text-gray-500\">45.2</div>\n            </div>\n        </div>\n\n        <!-- Annunciator Panel Controls -->\n        <div class=\"col-span-2 grid grid-rows-3 gap-2\">\n            <button class=\"bg-gray-800 border border-gray-600 rounded text-danger font-bold text-xs hover:bg-gray-700 active:bg-red-900 transition flex items-center justify-center flex-col shadow-lg\" onclick=\"toggleWarning('MASTER WARN')\">\n                <span class=\"text-lg\">⚠</span> MASTER WARN\n            </button>\n            <button class=\"bg-gray-800 border border-gray-600 rounded text-warning font-bold text-xs hover:bg-gray-700 active:bg-yellow-900 transition flex items-center justify-center flex-col shadow-lg\" onclick=\"toggleWarning('MASTER CAUT')\">\n                <span class=\"text-lg\">!</span> MASTER CAUT\n            </button>\n            <button class=\"bg-gray-800 border border-gray-600 rounded text-primary font-bold text-xs hover:bg-gray-700 active:bg-blue-900 transition flex items-center justify-center shadow-lg\" onclick=\"clearWarnings()\">\n                CLR MSG\n            </button>\n        </div>\n    </div>\n\n    <script>\n        /* --- STATE MANAGEMENT --- */\n        const state = {\n            pitch: 0, // degrees\n            roll: 0,  // degrees\n            heading: 245,\n            altitude: 15200,\n            speed: 240,\n            targetAlt: 280,\n            targetHdg: 245,\n            vSpeed: 1200,\n            engine: {\n                n1: 88.4,\n                n2: 91.2,\n                egt: 560\n            },\n            radio: 124.850,\n            warnings: [],\n            waypoints: [\n                {id: 'KBFI', x: 0.2, y: 0.8},\n                {id: 'SEA', x: 0.3, y: 0.6},\n                {id: 'OLM', x: 0.5, y: 0.4},\n                {id: 'HQM', x: 0.7, y: 0.3},\n                {id: 'KSEA', x: 0.9, y: 0.1}\n            ]\n        };\n\n        /* --- PFD RENDERING --- */\n        const pfdCanvas = document.getElementById('pfd-canvas');\n        const pfdCtx = pfdCanvas.getContext('2d');\n        const horizonEl = document.getElementById('horizon-line');\n        const spdTape = document.getElementById('spd-tape');\n        const altTape = document.getElementById('alt-tape');\n        const hdgTape = document.getElementById('hdg-tape');\n\n        function resizeCanvas() {\n            pfdCanvas.width = pfdCanvas.parentElement.clientWidth;\n            pfdCanvas.height = pfdCanvas.parentElement.clientHeight;\n        }\n        window.addEventListener('resize', resizeCanvas);\n        resizeCanvas();\n\n        // Initialize tapes\n        function initTapes() {\n            let spdHtml = '';\n            for(let i = 50; i <= 450; i+=5) {\n                spdHtml += `<div class=\"h-6 text-xs text-white w-full text-right pr-2 border-r border-gray-500 relative\">\n                    <span class=\"${i%10===0?'font-bold text-sm':''}\">${i}</span>\n                    ${i%10===0?'<div class=\"absolute right-0 top-1/2 w-2 h-[1px] bg-white\"></div>':''}\n                </div>`;\n            }\n            spdTape.innerHTML = spdHtml;\n\n            let altHtml = '';\n            for(let i = 0; i <= 50000; i+=100) {\n                altHtml += `<div class=\"h-8 text-xs text-white w-full text-left pl-2 border-l border-gray-500 relative flex items-center\">\n                    <span class=\"${i%500===0?'font-bold text-sm':''}\">${i}</span>\n                    ${i%500===0?'<div class=\"absolute left-0 top-1/2 w-2 h-[1px] bg-white\"></div>':''}\n                </div>`;\n            }\n            altTape.innerHTML = altHtml;\n\n            let hdgHtml = '';\n            const directions = ['N', '3', '6', 'E', '12', '15', 'S', '21', '24', 'W', '30', '33'];\n            for(let i=0; i<12; i++) {\n                let deg = i * 30;\n                hdgHtml += `<div class=\"w-12 flex-shrink-0 text-center relative pt-2\">\n                    <div class=\"h-2 border-l border-white mx-auto mb-1\"></div>\n                    <span class=\"text-xs font-bold ${i%3===0?'text-white':'text-gray-500'}\">${i%3===0 ? directions[i] : deg}</span>\n                </div>`;\n            }\n            hdgTape.innerHTML = hdgHtml;\n        }\n        initTapes();\n\n        /* --- ND (NAV) RENDERING --- */\n        const ndCanvas = document.getElementById('nd-canvas');\n        const ndCtx = ndCanvas.getContext('2d');\n\n        function updateNavDisplay() {\n            ndCanvas.width = ndCanvas.parentElement.clientWidth;\n            ndCanvas.height = ndCanvas.parentElement.clientHeight;\n            \n            const cx = ndCanvas.width / 2;\n            const cy = ndCanvas.height / 2;\n            const radius = Math.min(cx, cy) * 0.9;\n\n            ndCtx.clearRect(0, 0, ndCanvas.width, ndCanvas.height);\n\n            // Compass Rose\n            ndCtx.strokeStyle = '#333';\n            ndCtx.lineWidth = 2;\n            ndCtx.beginPath();\n            ndCtx.arc(cx, cy, radius, 0, Math.PI * 2);\n            ndCtx.stroke();\n\n            // Heading Indicators on Rose\n            for(let i=0; i<360; i+=30) {\n                const rad = (i - 90) * Math.PI / 180;\n                const x1 = cx + Math.cos(rad) * radius;\n                const y1 = cy + Math.sin(rad) * radius;\n                const x2 = cx + Math.cos(rad) * (radius - 10);\n                const y2 = cy + Math.sin(rad) * (radius - 10);\n                \n                ndCtx.beginPath();\n                ndCtx.moveTo(x1, y1);\n                ndCtx.lineTo(x2, y2);\n                ndCtx.strokeStyle = i === 0 ? '#ff3333' : '#666';\n                ndCtx.stroke();\n            }\n\n            // Rotated Map Content (Simulated)\n            // In a real system, everything rotates based on heading. Here we simplify to view mode.\n            \n            // Draw Route Line\n            ndCtx.beginPath();\n            ndCtx.strokeStyle = '#d4af37'; // Magenta/Dark Gold\n            ndCtx.lineWidth = 3;\n            ndCtx.setLineDash([5, 5]);\n            \n            // Draw Arc Route\n            state.waypoints.forEach((wp, index) => {\n                const wx = cx + (wp.x - 0.5) * radius * 1.5;\n                const wy = cy + (wp.y - 0.5) * radius * 1.5;\n                if(index === 0) ndCtx.moveTo(wx, wy);\n                else ndCtx.lineTo(wx, wy);\n                \n                // Draw WP Circle\n                ndCtx.fillStyle = 'black';\n                ndCtx.strokeStyle = '#d4af37';\n                ndCtx.lineWidth = 2;\n                ndCtx.setLineDash([]);\n                ndCtx.beginPath();\n                ndCtx.arc(wx, wy, 5, 0, Math.PI*2);\n                ndCtx.fill();\n                ndCtx.stroke();\n                \n                // Text\n                ndCtx.fillStyle = '#fff';\n                ndCtx.font = '10px monospace';\n                ndCtx.fillText(wp.id, wx + 8, wy + 3);\n            });\n            ndCtx.stroke();\n\n            // Ownship\n            ndCtx.fillStyle = '#000';\n            ndCtx.strokeStyle = '#fff';\n            ndCtx.lineWidth = 2;\n            ndCtx.beginPath();\n            ndCtx.moveTo(cx, cy - 10);\n            ndCtx.lineTo(cx + 8, cy + 5);\n            ndCtx.lineTo(cx - 8, cy + 5);\n            ndCtx.closePath();\n            ndCtx.fill();\n            ndCtx.stroke();\n            \n            // VOR Needle\n            const vorRad = 45 * Math.PI / 180; // Fake VOR bearing\n            ndCtx.save();\n            ndCtx.translate(cx, cy);\n            ndCtx.rotate(vorRad);\n            ndCtx.strokeStyle = '#00d2ff';\n            ndCtx.lineWidth = 2;\n            ndCtx.beginPath();\n            ndCtx.moveTo(0, -radius + 10);\n            ndCtx.lineTo(0, -20);\n            ndCtx.moveTo(0, 20);\n            ndCtx.lineTo(0, radius - 10);\n            ndCtx.stroke();\n            ndCtx.restore();\n        }\n\n        /* --- MAIN LOOP --- */\n        function updateDisplays() {\n            // 1. Update Tapes Position\n            // Speed: 12px per unit approx.\n            const spdOffset = (state.speed - 50) * 6; \n            spdTape.style.transform = `translateY(${spdOffset}px)`;\n            document.getElementById('spd-readout').innerText = Math.floor(state.speed);\n\n            // Alt: 2px per 100ft? \n            // Ticks are h-8 (32px) for 100ft. So 0.32px per ft.\n            const altOffset = (state.altitude / 50) * 6; // Rough scaling\n            altTape.style.transform = `translateY(${altOffset}px)`;\n            document.getElementById('alt-readout').innerText = Math.floor(state.altitude);\n\n            // Hdg: 12 items. width 48px each.\n            const hdgOffset = (state.heading / 30) * 48 * -1 + (hdgTape.parentElement.clientWidth/2) - 24;\n            hdgTape.style.transform = `translateX(${hdgOffset}px)`;\n            \n            // 2. Update Horizon\n            // Pitch: 1 deg = 5px roughly\n            // Roll: CSS rotate\n            const pitchPx = state.pitch * 8;\n            horizonEl.style.transform = `rotate(${-state.roll}deg) translateY(${pitchPx}px)`;\n\n            // 3. Draw PFD Overlays (Pitch Ladder, FD)\n            drawPFDOverlays();\n\n            // 4. Update Engine Bars\n            document.getElementById('n1-bar').style.width = state.engine.n1 + '%';\n            document.getElementById('n1-val').innerText = state.engine.n1.toFixed(1) + '%';\n            \n            document.getElementById('n2-bar').style.width = state.engine.n2 + '%';\n            document.getElementById('n2-val').innerText = state.engine.n2.toFixed(1) + '%';\n            \n            document.getElementById('egt-bar').style.width = (state.engine.egt / 10) + '%';\n            document.getElementById('egt-val').innerText = Math.floor(state.engine.egt) + '°C';\n\n            // 5. ND\n            updateNavDisplay();\n\n            // 6. Clock\n            const now = new Date();\n            document.getElementById('clock').innerText = now.toISOString().split('T')[1].split('.')[0];\n        }\n\n        function drawPFDOverlays() {\n            const w = pfdCanvas.width;\n            const h = pfdCanvas.height;\n            pfdCtx.clearRect(0, 0, w, h);\n\n            // Draw Pitch Ladder Lines on Canvas (Perspective)\n            pfdCtx.save();\n            pfdCtx.translate(w/2, h/2);\n            pfdCtx.rotate(-state.roll * Math.PI / 180);\n            pfdCtx.translate(0, state.pitch * 8); // Move opposite to horizon translation logic or sync with it\n\n            pfdCtx.strokeStyle = 'white';\n            pfdCtx.lineWidth = 2;\n            pfdCtx.fillStyle = 'white';\n            pfdCtx.textAlign = 'center';\n            pfdCtx.font = '14px monospace';\n\n            // Draw pitch lines (-20 to +20 deg)\n            for(let i = -20; i <= 20; i+=5) {\n                if(i === 0) continue; // Horizon line is handled by the DOM div gradient mask\n                const y = -i * 8; // 8px per degree\n                let width = 20;\n                if(i % 10 === 0) width = 40;\n                \n                pfdCtx.beginPath();\n                pfdCtx.moveTo(-width, y);\n                pfdCtx.lineTo(width, y);\n                pfdCtx.stroke();\n\n                if(i % 10 === 0) {\n                    pfdCtx.fillText(i, -width - 10, y + 4);\n                    pfdCtx.fillText(i, width + 10, y + 4);\n                }\n            }\n            pfdCtx.restore();\n        }\n\n        /* --- INTERACTION LOGIC --- */\n        \n        // Simulate flight dynamics\n        setInterval(() => {\n            // Oscillate slightly\n            const time = Date.now() / 1000;\n            state.roll = Math.sin(time) * 2; \n            state.pitch = Math.sin(time * 0.7) * 1 + 2;\n            \n            // Slowly move speed/alt based on AP\n            if(state.altitude < state.targetAlt * 100) state.altitude += 10;\n            if(state.altitude > state.targetAlt * 100) state.altitude -= 10;\n            \n            // Random engine fluctuation\n            state.engine.n1 = 88.4 + (Math.random() - 0.5);\n            state.engine.egt = 560 + (Math.random() * 10 - 5);\n\n            updateDisplays();\n        }, 50);\n\n        function adjustAlt(amount) {\n            state.targetAlt += amount;\n            document.getElementById('alt-val').innerText = `FL${Math.floor(state.targetAlt/100)}`;\n            // Visual feedback on button screen could go here\n        }\n\n        function tuneRadio(amount) {\n            state.radio += amount;\n            document.getElementById('com-display').innerText = state.radio.toFixed(3);\n        }\n\n        function swapRadio() {\n            const el = document.getElementById('com-display');\n            el.classList.add('text-warning');\n            setTimeout(() => el.classList.remove('text-warning'), 200);\n        }\n\n        /* --- WARNING SYSTEM --- */\n        const warningPanel = document.getElementById('master-warning-panel');\n        \n        function toggleWarning(type) {\n            const id = Date.now();\n            const el = document.createElement('div');\n            el.className = `px-2 py-1 rounded text-xs font-bold animate-pulse border border-white ${type === 'MASTER WARN' ? 'bg-danger text-white' : 'bg-warning text-black'}`;\n            el.innerText = type;\n            el.id = `warn-${id}`;\n            \n            // Remove previous if exists to avoid clutter\n            if(warningPanel.children.length > 3) warningPanel.innerHTML = '';\n            \n            warningPanel.appendChild(el);\n            state.warnings.push({id, el});\n        }\n\n        function clearWarnings() {\n            warningPanel.innerHTML = '';\n            state.warnings = [];\n        }\n\n        /* --- FMS INTERACTION SIMULATOR --- */\n        // Just a visual toggle for the FMS list for now to show interactivity\n        const fmsScreen = document.getElementById('fms-screen');\n        let fmsActive = 2; // OLM active\n        \n        // Simulate progression\n        setInterval(() => {\n            const rows = fmsScreen.innerHTML.split('</div>').filter(r => r.includes('WPT') || r.includes('KBFI') || r.includes('SEA') || r.includes('OLM') || r.includes('HQM') || r.includes('KSEA') || r.includes('text-gray'));\n            // This is a messy way to parse HTML string, but for a pure HTML/JS file without a framework, it's proof of concept.\n            // In a real app, we'd template this properly.\n        }, 5000);\n\n        // Initial render\n        updateDisplays();\n\n    </script>\n</body>\n</html>\n```"
}