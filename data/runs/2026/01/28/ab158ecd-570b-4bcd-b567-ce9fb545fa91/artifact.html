<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Desktop Environment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }
        .desktop-bg {
            background-image: url('https://picsum.photos/seed/macos-wallpaper/1920/1080.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 100vh;
            position: relative;
        }
        .window {
            position: absolute;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            overflow: hidden;
            min-width: 300px;
            min-height: 200px;
        }
        .window-header {
            cursor: move;
            background: linear-gradient(to bottom, #e6e6e6, #d9d9d9);
            border-bottom: 1px solid #bbb;
            display: flex;
            align-items: center;
            padding: 5px 10px;
            height: 28px;
        }
        .window-controls {
            display: flex;
            gap: 8px;
            margin-right: 10px;
        }
        .window-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }
        .resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            cursor: nwse-resize;
            z-index: 10;
        }
        .dock-item {
            transition: all 0.2s ease;
            transform-origin: bottom center;
        }
        .mission-control-window {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .mission-control-window:hover {
            border-color: #3282d8;
            transform: scale(1.05);
        }
        .desktop-space {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
        }
        .desktop-space.active {
            display: block;
        }
    </style>
</head>
<body>
    <div id="desktop-container" class="relative w-full h-screen">
        <!-- Desktop Background -->
        <div class="desktop-bg">
            <!-- Desktop Space 1 -->
            <div id="space-1" class="desktop-space active">
                <!-- Desktop Icons -->
                <div class="absolute top-10 left-10 flex flex-col items-center text-white text-xs" draggable="true">
                    <div class="w-16 h-16 mb-1 rounded-lg bg-blue-500/20 backdrop-blur-sm flex items-center justify-center">
                        <i class="fas fa-folder text-3xl text-white"></i>
                    </div>
                    <span>Documents</span>
                </div>
                <div class="absolute top-32 left-10 flex flex-col items-center text-white text-xs" draggable="true">
                    <div class="w-16 h-16 mb-1 rounded-lg bg-green-500/20 backdrop-blur-sm flex items-center justify-center">
                        <i class="fas fa-download text-3xl text-white"></i>
                    </div>
                    <span>Downloads</span>
                </div>
            </div>
            
            <!-- Desktop Space 2 -->
            <div id="space-2" class="desktop-space">
                <div class="absolute top-10 left-10 flex flex-col items-center text-white text-xs" draggable="true">
                    <div class="w-16 h-16 mb-1 rounded-lg bg-purple-500/20 backdrop-blur-sm flex items-center justify-center">
                        <i class="fas fa-image text-3xl text-white"></i>
                    </div>
                    <span>Pictures</span>
                </div>
            </div>
            
            <!-- Desktop Space 3 -->
            <div id="space-3" class="desktop-space">
                <div class="absolute top-10 left-10 flex flex-col items-center text-white text-xs" draggable="true">
                    <div class="w-16 h-16 mb-1 rounded-lg bg-yellow-500/20 backdrop-blur-sm flex items-center justify-center">
                        <i class="fas fa-music text-3xl text-white"></i>
                    </div>
                    <span>Music</span>
                </div>
            </div>
        </div>
        
        <!-- Top Menu Bar -->
        <div class="absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-black/80 to-black/50 backdrop-blur-sm flex items-center px-4 text-white text-sm z-50">
            <div class="flex items-center space-x-6">
                <div class="font-bold">Finder</div>
                <div class="flex space-x-4">
                    <div id="file-menu" class="hover:underline cursor-pointer">File</div>
                    <div id="edit-menu" class="hover:underline cursor-pointer">Edit</div>
                    <div id="view-menu" class="hover:underline cursor-pointer">View</div>
                    <div id="go-menu" class="hover:underline cursor-pointer">Go</div>
                    <div id="window-menu" class="hover:underline cursor-pointer">Window</div>
                    <div id="help-menu" class="hover:underline cursor-pointer">Help</div>
                </div>
            </div>
            
            <div class="absolute right-4 flex items-center space-x-4">
                <div id="wifi-icon" class="cursor-pointer"><i class="fas fa-wifi"></i></div>
                <div id="battery-icon" class="cursor-pointer"><i class="fas fa-battery-three-quarters"></i></div>
                <div id="date-time" class="cursor-pointer">9:41 AM</div>
                <div id="notification-center-toggle" class="cursor-pointer"><i class="fas fa-bell"></i></div>
                <div id="spotlight-toggle" class="cursor-pointer"><i class="fas fa-search"></i></div>
            </div>
        </div>
        
        <!-- Windows Container -->
        <div id="windows-container" class="absolute inset-0 pointer-events-none">
            <!-- Windows will be dynamically created here -->
        </div>
        
        <!-- Dock -->
        <div id="dock" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/30 backdrop-blur-lg rounded-xl px-4 py-2 flex items-end space-x-2 h-16">
            <div class="dock-item w-12 h-12 flex items-center justify-center cursor-pointer" data-app="finder">
                <i class="fas fa-folder text-white text-2xl"></i>
            </div>
            <div class="dock-item w-12 h-12 flex items-center justify-center cursor-pointer" data-app="settings">
                <i class="fas fa-cog text-white text-2xl"></i>
            </div>
            <div class="dock-item w-12 h-12 flex items-center justify-center cursor-pointer" data-app="calculator">
                <i class="fas fa-calculator text-white text-2xl"></i>
            </div>
            <div class="dock-item w-12 h-12 flex items-center justify-center cursor-pointer" data-app="notes">
                <i class="fas fa-sticky-note text-white text-2xl"></i>
            </div>
            <div class="dock-item w-12 h-12 flex items-center justify-center cursor-pointer" data-app="calendar">
                <i class="fas fa-calendar-alt text-white text-2xl"></i>
            </div>
        </div>
        
        <!-- Mission Control -->
        <div id="mission-control" class="absolute inset-0 bg-black/80 backdrop-blur-lg z-50 hidden">
            <div class="absolute top-10 left-10 text-white text-2xl font-bold">Mission Control</div>
            <div class="absolute bottom-20 left-1/2 transform -translate-x-1/2 flex space-x-4">
                <div class="mission-control-window bg-white/10 backdrop-blur-sm rounded-lg w-64 h-48 border border-white/20 flex flex-col items-center justify-center text-white" data-space="1">
                    <i class="fas fa-desktop text-4xl mb-2"></i>
                    <div>Desktop 1</div>
                </div>
                <div class="mission-control-window bg-white/10 backdrop-blur-sm rounded-lg w-64 h-48 border border-white/20 flex flex-col items-center justify-center text-white" data-space="2">
                    <i class="fas fa-desktop text-4xl mb-2"></i>
                    <div>Desktop 2</div>
                </div>
                <div class="mission-control-window bg-white/10 backdrop-blur-sm rounded-lg w-64 h-48 border border-white/20 flex flex-col items-center justify-center text-white" data-space="3">
                    <i class="fas fa-desktop text-4xl mb-2"></i>
                    <div>Desktop 3</div>
                </div>
            </div>
            <div id="close-mission-control" class="absolute top-10 right-10 text-white text-2xl cursor-pointer hover:text-gray-300">
                <i class="fas fa-times"></i>
            </div>
        </div>
        
        <!-- Spotlight Search -->
        <div id="spotlight" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-xl rounded-xl w-96 hidden z-50">
            <div class="p-4">
                <div class="flex items-center mb-4">
                    <i class="fas fa-search text-white mr-3"></i>
                    <input type="text" id="spotlight-input" class="bg-transparent text-white w-full outline-none text-lg" placeholder="Search" autofocus>
                </div>
                <div class="border-t border-gray-600 pt-2">
                    <div class="flex items-center py-2 text-white/80 hover:bg-white/10 rounded px-2 cursor-pointer">
                        <i class="fas fa-folder mr-3"></i>
                        <span>Folders</span>
                    </div>
                    <div class="flex items-center py-2 text-white/80 hover:bg-white/10 rounded px-2 cursor-pointer">
                        <i class="fas fa-file-alt mr-3"></i>
                        <span>Documents</span>
                    </div>
                    <div class="flex items-center py-2 text-white/80 hover:bg-white/10 rounded px-2 cursor-pointer">
                        <i class="fas fa-image mr-3"></i>
                        <span>Images</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Notification Center -->
        <div id="notification-center" class="absolute top-8 right-0 w-80 h-[calc(100vh-32px)] bg-black/50 backdrop-blur-lg transform translate-x-full transition-transform duration-300 z-50">
            <div class="p-4 text-white">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Notifications</h2>
                    <button id="clear-notifications" class="text-sm text-gray-300 hover:text-white">Clear All</button>
                </div>
                <div class="space-y-3">
                    <div class="bg-black/30 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold">Calendar</div>
                                <div class="text-sm">Meeting at 10:30 AM</div>
                            </div>
                            <div class="text-xs">9:41 AM</div>
                        </div>
                    </div>
                    <div class="bg-black/30 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold">Mail</div>
                                <div class="text-sm">New message from John</div>
                            </div>
                            <div class="text-xs">9:30 AM</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let currentSpace = 1;
        let windows = [];
        let activeWindow = null;
        let isDragging = false;
        let isResizing = false;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let dockItems = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeDock();
            initializeMenu();
            initializeWindows();
            initializeSpotlight();
            initializeNotificationCenter();
            initializeMissionControl();
            initializeSpaces();
            updateTime();
            setInterval(updateTime, 60000); // Update time every minute
        });
        
        // Initialize Dock with magnification
        function initializeDock() {
            const dock = document.getElementById('dock');
            dockItems = Array.from(dock.querySelectorAll('.dock-item'));
            
            dock.addEventListener('mousemove', (e) => {
                const mouseX = e.clientX;
                dockItems.forEach(item => {
                    const itemRect = item.getBoundingClientRect();
                    const itemCenterX = itemRect.left + itemRect.width / 2;
                    const distance = Math.abs(mouseX - itemCenterX);
                    
                    if (distance < 80) {
                        const scale = 1 + (80 - distance) / 80 * 0.5;
                        item.style.transform = `scale(${scale}) translateY(-${(scale - 1) * 20}px)`;
                    } else {
                        item.style.transform = 'scale(1)';
                    }
                });
            });
            
            dock.addEventListener('mouseleave', () => {
                dockItems.forEach(item => {
                    item.style.transform = 'scale(1)';
                });
            });
            
            // App click handlers
            dockItems.forEach(item => {
                item.addEventListener('click', () => {
                    const app = item.dataset.app;
                    openApp(app);
                });
            });
        }
        
        // Open app window
        function openApp(appName) {
            const windowsContainer = document.getElementById('windows-container');
            let window = windows.find(w => w.app === appName && w.space === currentSpace);
            
            if (!window) {
                window = createAppWindow(appName);
                windows.push(window);
                windowsContainer.appendChild(window.element);
            } else {
                // Focus existing window
                bringToFront(window);
            }
        }
        
        // Create app window
        function createAppWindow(appName) {
            const windowDiv = document.createElement('div');
            windowDiv.className = 'window bg-white';
            windowDiv.style.left = '100px';
            windowDiv.style.top = '100px';
            windowDiv.style.width = '600px';
            windowDiv.style.height = '400px';
            
            const header = document.createElement('div');
            header.className = 'window-header';
            
            const controls = document.createElement('div');
            controls.className = 'window-controls';
            
            const closeBtn = document.createElement('div');
            closeBtn.className = 'window-control bg-red-500';
            closeBtn.addEventListener('click', () => closeWindow(window));
            
            const minimizeBtn = document.createElement('div');
            minimizeBtn.className = 'window-control bg-yellow-500';
            minimizeBtn.addEventListener('click', () => minimizeWindow(window));
            
            const maximizeBtn = document.createElement('div');
            maximizeBtn.className = 'window-control bg-green-500';
            maximizeBtn.addEventListener('click', () => maximizeWindow(window));
            
            controls.appendChild(closeBtn);
            controls.appendChild(minimizeBtn);
            controls.appendChild(maximizeBtn);
            
            const title = document.createElement('div');
            title.className = 'text-sm text-gray-700 flex-grow';
            
            const content = document.createElement('div');
            content.className = 'p-4 h-full overflow-auto';
            
            // Set window content based on app
            switch(appName) {
                case 'finder':
                    title.textContent = 'Finder';
                    content.innerHTML = `
                        <div class="flex h-full">
                            <div class="w-48 bg-gray-100 p-2">
                                <div class="mb-2"><i class="fas fa-folder mr-2"></i>Documents</div>
                                <div class="mb-2"><i class="fas fa-download mr-2"></i>Downloads</div>
                                <div class="mb-2"><i class="fas fa-image mr-2"></i>Pictures</div>
                                <div class="mb-2"><i class="fas fa-music mr-2"></i>Music</div>
                            </div>
                            <div class="flex-grow">
                                <div class="flex items-center p-2 bg-gray-100 border-b">
                                    <i class="fas fa-arrow-left mr-4 text-gray-500"></i>
                                    <i class="fas fa-arrow-right mr-4 text-gray-500"></i>
                                    <div class="text-gray-700">Documents</div>
                                </div>
                                <div class="p-4">
                                    <div class="grid grid-cols-4 gap-4">
                                        <div class="text-center">
                                            <div class="w-16 h-16 mx-auto bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                                <i class="fas fa-file-alt text-blue-500 text-2xl"></i>
                                            </div>
                                            <div class="text-sm">Document 1</div>
                                        </div>
                                        <div class="text-center">
                                            <div class="w-16 h-16 mx-auto bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                                <i class="fas fa-file-alt text-blue-500 text-2xl"></i>
                                            </div>
                                            <div class="text-sm">Document 2</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'settings':
                    title.textContent = 'System Preferences';
                    content.innerHTML = `
                        <div class="grid grid-cols-4 gap-4">
                            <div class="text-center p-3 hover:bg-gray-100 rounded-lg cursor-pointer">
                                <div class="w-12 h-12 mx-auto bg-blue-100 rounded-lg flex items-center justify-center mb-2">
                                    <i class="fas fa-desktop text-blue-500"></i>
                                </div>
                                <div class="text-xs">General</div>
                            </div>
                            <div class="text-center p-3 hover:bg-gray-100 rounded-lg cursor-pointer">
                                <div class="w-12 h-12 mx-auto bg-purple-100 rounded-lg flex items-center justify-center mb-2">
                                    <i class="fas fa-paint-brush text-purple-500"></i>
                                </div>
                                <div class="text-xs">Desktop & Screen Saver</div>
                            </div>
                            <div class="text-center p-3 hover:bg-gray-100 rounded-lg cursor-pointer">
                                <div class="w-12 h-12 mx-auto bg-green-100 rounded-lg flex items-center justify-center mb-2">
                                    <i class="fas fa-dock text-green-500"></i>
                                </div>
                                <div class="text-xs">Dock</div>
                            </div>
                            <div class="text-center p-3 hover:bg-gray-100 rounded-lg cursor-pointer">
                                <div class="w-12 h-12 mx-auto bg-red-100 rounded-lg flex items-center justify-center mb-2">
                                    <i class="fas fa-shield-alt text-red-500"></i>
                                </div>
                                <div class="text-xs">Security & Privacy</div>
                            </div>
                        </div>
                    `;
                    break;
                case 'calculator':
                    title.textContent = 'Calculator';
                    content.innerHTML = `
                        <div class="flex flex-col items-center justify-center h-full">
                            <div class="bg-black text-white text-right p-3 rounded-t-lg w-64">
                                <div class="text-2xl">0</div>
                            </div>
                            <div class="grid grid-cols-4 gap-1 w-64">
                                <button class="bg-gray-200 p-4 rounded hover:bg-gray-300">C</button>
                                <button class="bg-gray-200 p-4 rounded hover:bg-gray-300">+/-</button>
                                <button class="bg-gray-200 p-4 rounded hover:bg-gray-300">%</button>
                                <button class="bg-orange-500 text-white p-4 rounded hover:bg-orange-600">รท</button>
                                
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">7</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">8</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">9</button>
                                <button class="bg-orange-500 text-white p-4 rounded hover:bg-orange-600">ร</button>
                                
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">4</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">5</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">6</button>
                                <button class="bg-orange-500 text-white p-4 rounded hover:bg-orange-600">-</button>
                                
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">1</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">2</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">3</button>
                                <button class="bg-orange-500 text-white p-4 rounded hover:bg-orange-600">+</button>
                                
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border col-span-2">0</button>
                                <button class="bg-white p-4 rounded hover:bg-gray-100 border">.</button>
                                <button class="bg-orange-500 text-white p-4 rounded hover:bg-orange-600">=</button>
                            </div>
                        </div>
                    `;
                    break;
                case 'notes':
                    title.textContent = 'Notes';
                    content.innerHTML = `
                        <div class="flex h-full">
                            <div class="w-1/4 bg-gray-50 border-r p-2">
                                <div class="font-semibold mb-2">Notes</div>
                                <div class="text-sm p-2 hover:bg-gray-200 rounded cursor-pointer">
                                    <div class="font-medium">Shopping List</div>
                                    <div class="text-gray-500 text-xs">Milk, Eggs, Bread...</div>
                                </div>
                                <div class="text-sm p-2 hover:bg-gray-200 rounded cursor-pointer">
                                    <div class="font-medium">Meeting Notes</div>
                                    <div class="text-gray-500 text-xs">Discussion about...</div>
                                </div>
                                <div class="mt-4 text-blue-500 text-sm cursor-pointer">
                                    <i class="fas fa-plus mr-1"></i>New Note
                                </div>
                            </div>
                            <div class="flex-grow p-4">
                                <div class="border-b pb-2 mb-4">
                                    <h2 class="text-xl font-bold">Shopping List</h2>
                                </div>
                                <div class="mb-4">
                                    <div class="flex items-center mb-1">
                                        <input type="checkbox" class="mr-2">
                                        <span>Milk</span>
                                    </div>
                                    <div class="flex items-center mb-1">
                                        <input type="checkbox" class="mr-2">
                                        <span>Eggs</span>
                                    </div>
                                    <div class="flex items-center mb-1">
                                        <input type="checkbox" class="mr-2" checked>
                                        <span class="line-through text-gray-400">Bread</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'calendar':
                    title.textContent = 'Calendar';
                    content.innerHTML = `
                        <div class="p-4">
                            <div class="flex justify-between items-center mb-4">
                                <button class="p-2 hover:bg-gray-100 rounded">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <div class="font-bold text-lg">June 2023</div>
                                <button class="p-2 hover:bg-gray-100 rounded">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 mb-2">
                                <div class="text-center text-gray-500 text-sm">Sun</div>
                                <div class="text-center text-gray-500 text-sm">Mon</div>
                                <div class="text-center text-gray-500 text-sm">Tue</div>
                                <div class="text-center text-gray-500 text-sm">Wed</div>
                                <div class="text-center text-gray-500 text-sm">Thu</div>
                                <div class="text-center text-gray-500 text-sm">Fri</div>
                                <div class="text-center text-gray-500 text-sm">Sat</div>
                            </div>
                            <div class="grid grid-cols-7 gap-1">
                                ${Array.from({length: 35}, (_, i) => 
                                    `<div class="h-12 border rounded hover:bg-gray-100 flex items-center justify-center text-sm ${i < 4 || i > 34 ? 'text-gray-300' : ''} ${i === 15 ? 'bg-blue-100' : ''}">${i < 4 ? 28 + i : i < 34 ? i - 3 : i - 34}</div>`
                                ).join('')}
                            </div>
                            <div class="mt-4">
                                <div class="font-semibold mb-2">Today</div>
                                <div class="bg-blue-50 p-3 rounded-lg">
                                    <div class="font-medium">Team Meeting</div>
                                    <div class="text-sm text-gray-600">10:30 AM - 11:30 AM</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }
            
            header.appendChild(controls);
            header.appendChild(title);
            
            const resizeHandle = document.createElement('div');
            resizeHandle.className = 'resize-handle';
            
            windowDiv.appendChild(header);
            windowDiv.appendChild(content);
            windowDiv.appendChild(resizeHandle);
            
            // Make window draggable
            header.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('window-control')) return;
                isDragging = true;
                activeWindow = window;
                dragOffsetX = e.clientX - windowDiv.offsetLeft;
                dragOffsetY = e.clientY - windowDiv.offsetTop;
                bringToFront(window);
            });
            
            // Make window resizable
            resizeHandle.addEventListener('mousedown', (e) => {
                isResizing = true;
                activeWindow = window;
                e.stopPropagation();
            });
            
            return {
                element: windowDiv,
                app: appName,
                space: currentSpace,
                minimized: false
            };
        }
        
        // Window management functions
        function bringToFront(window) {
            const allWindows = document.querySelectorAll('.window');
            allWindows.forEach(w => w.style.zIndex = 10);
            window.element.style.zIndex = 20;
        }
        
        function closeWindow(window) {
            const index = windows.indexOf(window);
            if (index > -1) {
                windows.splice(index, 1);
            }
            window.element.remove();
        }
        
        function minimizeWindow(window) {
            window.minimized = true;
            window.element.style.display = 'none';
        }
        
        function maximizeWindow(window) {
            window.element.style.left = '0';
            window.element.style.top = '32px';
            window.element.style.width = '100%';
            window.element.style.height = 'calc(100% - 32px)';
        }
        
        // Initialize window drag/resize handlers
        function initializeWindows() {
            document.addEventListener('mousemove', (e) => {
                if (isDragging && activeWindow) {
                    const windowDiv = activeWindow.element;
                    windowDiv.style.left = `${e.clientX - dragOffsetX}px`;
                    windowDiv.style.top = `${e.clientY - dragOffsetY}px`;
                }
                
                if (isResizing && activeWindow) {
                    const windowDiv = activeWindow.element;
                    const newWidth = e.clientX - windowDiv.offsetLeft;
                    const newHeight = e.clientY - windowDiv.offsetTop;
                    
                    if (newWidth > 300) windowDiv.style.width = `${newWidth}px`;
                    if (newHeight > 200) windowDiv.style.height = `${newHeight}px`;
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                isResizing = false;
            });
        }
        
        // Initialize menu bar
        function initializeMenu() {
            // Menu dropdowns could be implemented here
        }
        
        // Initialize Spotlight
        function initializeSpotlight() {
            const spotlightToggle = document.getElementById('spotlight-toggle');
            const spotlight = document.getElementById('spotlight');
            const spotlightInput = document.getElementById('spotlight-input');
            
            spotlightToggle.addEventListener('click', () => {
                spotlight.classList.toggle('hidden');
                spotlightInput.focus();
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    spotlight.classList.add('hidden');
                }
            });
        }
        
        // Initialize Notification Center
        function initializeNotificationCenter() {
            const notificationToggle = document.getElementById('notification-center-toggle');
            const notificationCenter = document.getElementById('notification-center');
            const clearNotifications = document.getElementById('clear-notifications');
            
            notificationToggle.addEventListener('click', () => {
                notificationCenter.style.transform = notificationCenter.style.transform === 'translateX(0)' ? 'translateX(100%)' : 'translateX(0)';
            });
            
            clearNotifications.addEventListener('click', () => {
                const notifications = notificationCenter.querySelectorAll('.bg-black\\/30');
                notifications.forEach(n => n.remove());
            });
        }
        
        // Initialize Mission Control
        function initializeMissionControl() {
            const missionControl = document.getElementById('mission-control');
            const closeMissionControl = document.getElementById('close-mission-control');
            const missionControlWindows = document.querySelectorAll('.mission-control-window');
            
            // Open Mission Control with trackpad gesture (3 fingers swipe up)
            document.addEventListener('keydown', (e) => {
                if (e.key === 'F3' || (e.ctrlKey && e.key === 'ArrowUp')) {
                    missionControl.classList.remove('hidden');
                }
            });
            
            closeMissionControl.addEventListener('click', () => {
                missionControl.classList.add('hidden');
            });
            
            missionControlWindows.forEach(window => {
                window.addEventListener('click', () => {
                    const space = window.dataset.space;
                    switchToSpace(parseInt(space));
                    missionControl.classList.add('hidden');
                });
            });
        }
        
        // Initialize Spaces (Desktops)
        function initializeSpaces() {
            // Switch spaces with trackpad gesture (3 or 4 fingers swipe)
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'ArrowRight') {
                    switchToSpace(Math.min(3, currentSpace + 1));
                } else if (e.ctrlKey && e.key === 'ArrowLeft') {
                    switchToSpace(Math.max(1, currentSpace - 1));
                }
            });
        }
        
        function switchToSpace(spaceNumber) {
            // Hide current space
            document.getElementById(`space-${currentSpace}`).classList.remove('active');
            
            // Hide windows in current space
            windows.filter(w => w.space === currentSpace).forEach(w => {
                w.element.style.display = 'none';
            });
            
            // Show new space
            currentSpace = spaceNumber;
            document.getElementById(`space-${currentSpace}`).classList.add('active');
            
            // Show windows in new space
            windows.filter(w => w.space === currentSpace && !w.minimized).forEach(w => {
                w.element.style.display = 'block';
            });
        }
        
        // Update time in menu bar
        function updateTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const formattedHours = hours % 12 || 12;
            const formattedMinutes = minutes.toString().padStart(2, '0');
            
            document.getElementById('date-time').textContent = `${formattedHours}:${formattedMinutes} ${ampm}`;
        }
    </script>
</body>
</html>